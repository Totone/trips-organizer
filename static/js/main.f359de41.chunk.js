(this["webpackJsonptrips-organizer"]=this["webpackJsonptrips-organizer"]||[]).push([[0],{37:function(e){e.exports=JSON.parse('{"Arrival is day after_one":"La date d\'arriv\xe9e est le lendemain du jour du d\xe9part","Arrival is day after_other":"La date d\'arriv\xe9e est {{count}} jours apr\xe8s celle du d\xe9part","Available trips list":"Liste des trajets disponibles","Book":"R\xe9server","Booked trips":"Trajets r\xe9serv\xe9s","Cancel book":"Annuler cette r\xe9servation","Choose bus stop":"Choisissez un arr\xeat de d\xe9part","Clear cache":"Les donn\xe9es r\xe9cup\xe9r\xe9es sont sauvegard\xe9es pour un acc\xe8s plus rapide. Cliquez pour effacer ces donn\xe9es et r\xe9cup\xe9rer les derni\xe8res mises \xe0 jour distantes","Date":"Date","Fetch all trips":"R\xe9cup\xe9rer tous les trajets disponibles depuis tous les arr\xeats","From where":"D\'o\xf9 souhaitez-vous partir ?","Hour":"Heure","No booked trip":"Vous n\'avez r\xe9serv\xe9 aucun trajet","Sort by time":"Trier le tableau des trajets disponibles en fonction de l\'heure","Sort by stop":"Trier le tableau des trajets disponibles en fonction du nom des arr\xeats","Trip":"Trajet"}')},38:function(e){e.exports=JSON.parse('{"request":{"stop":"La liste des arr\xeats n\'a pas pu \xeatre r\xe9cup\xe9r\xe9e"}}')},67:function(e,t,r){},68:function(e,t,r){},96:function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"common",(function(){return p})),r.d(n,"errors",(function(){return f}));var a=r(0),i=r.n(a),s=r(24),c=r.n(s),o=r(20),u=r(2),d=r(36),l=r(21),p=r(37),f=r(38),j={fr:Object(u.a)({},n)};d.a.use(l.e).init({resources:j,ns:["common","errors"],defaultNS:"common",fallbackLng:"fr",debug:!1,returnObjects:!0,interpolation:{escapeValue:!1}});d.a,r(67),r(68),r(69);var b=r(97),x=r(56),h=r(6),v=r(27),O={SELECT_DEFAULT_VALUE:"default",ARROW:" \u21d2 ",REQ_STATUS:{LOADING:"loading",IDLE:"idle",FAILED:"failed"},IDS:{BOOKED_TRIPS:"bookedTrips"}},m=r(12),g=r(50),T=r(1),S=function(e){var t=e.icon,r=void 0===t?"border":t;return Object(T.jsx)(m.a,{className:"w-100 text-center",children:Object(T.jsx)(g.a,{role:"status",animation:r,variant:"primary",children:Object(T.jsx)("span",{className:"visually-hidden",children:"Loading..."})})})},k=function(e){var t=e.label,r=e.value;return Object(T.jsx)("option",{value:t,children:r})},y=r(10),w=r(11),L=r.n(w),E=r(15),C=r(51),N=r.n(C),A=r(52);r.n(A).a.config();var R={BASE_URL:"https://6130d11c8066ca0017fdaa97.mockapi.io",FETCH_STOPS:{method:"get",uri:"/stops"},FETCH_TRIPS:{method:"get",uri:"/trips"},BOOK_TRIP:{method:"put",uri:"/book"},CANCEL_BOOK:{method:"delete",uri:"/book"}},B=N.a.create({baseURL:R.BASE_URL,timeout:1e4}),D={fetchBusStops:function(){return B.get(R.FETCH_STOPS.uri)},fetchTrips:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return B.get(R.FETCH_TRIPS.uri,e)},bookTrip:function(e){return B.put(R.BOOK_TRIP.uri+"/"+e)},cancelBookedTrip:function(e){return B.delete(R.CANCEL_BOOK.uri+"/"+e)}},_=D,I=function(){return new Promise((function(e,t){_.fetchBusStops().then((function(t){return e({data:t.data})})).catch(t)}))},F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new Promise((function(t,r){var n={};""!==e&&(n.departureStop=e),_.fetchTrips({params:n}).then((function(e){return t({data:e.data})})).catch(r)}))},U={fetchBusStops:I,bookTrip:function(e){return new Promise((function(t,r){_.bookTrip(e).then((function(e){return e.data.success?t():r()})).catch(r)}))},fetchTrips:F,cancelBookedTrip:function(e){return new Promise((function(e,t){setTimeout(e,1e3)}))}},P=Object(y.b)("stop/fetchStopsList",Object(E.a)(L.a.mark((function e(){var t;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I();case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))),q=Object(y.c)({name:"stop",initialState:{status:"idle",list:[],cached:[],current:"default"},reducers:{reset:function(e){e.current=O.SELECT_DEFAULT_VALUE,e.cached=[]},update:function(e,t){e.current=t.payload},cache:function(e,t){e.cached=t.payload}},extraReducers:function(e){e.addCase(P.pending,(function(e){e.status="loading"})).addCase(P.rejected,(function(e){e.status="failed"})).addCase(P.fulfilled,(function(e,t){e.status="idle",e.list=t.payload}))}}),H=q.actions,z=H.reset,K=H.update,M=H.cache,V=function(e){return e.stop.cached},G=function(e){return e.stop.current},J=function(e){return e.stop.list},W=function(e){return e.stop.status},Q=q.reducer,Y=Object(y.b)("trip/fetchTripsList",function(){var e=Object(E.a)(L.a.mark((function e(t){var r;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F(t);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),$=Object(y.c)({name:"trip",initialState:{status:"idle",list:[],cached:[]},reducers:{reset:function(e){e.cached=[],e.list=[]},update:function(e,t){e.list=t.payload}},extraReducers:function(e){e.addCase(Y.pending,(function(e){e.status="loading"})).addCase(Y.rejected,(function(e){e.status="failed"})).addCase(Y.fulfilled,(function(e,t){e.status="idle",e.list=t.payload,e.cached=e.cached.concat(t.payload)}))}}),X=$.actions,Z=X.reset,ee=X.update,te=function(e){return e.trip.cached},re=function(e){return e.trip.list},ne=function(e){return e.trip.status},ae=$.reducer,ie="book/bookTrip",se="book/cancelBookedTrip",ce=Object(y.b)(ie,function(){var e=Object(E.a)(L.a.mark((function e(t,r){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.getState().book.list.find((function(e){return e.id===t.id}))){e.next=5;break}return e.next=4,U.bookTrip(t.id);case 4:return e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),oe=Object(y.b)(se,function(){var e=Object(E.a)(L.a.mark((function e(t){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.cancelBookedTrip(t);case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ue=Object(y.c)({name:"book",initialState:{status:{book:"idle",cancel:"idle"},list:[]},reducers:{},extraReducers:function(e){e.addCase(ce.pending,(function(e){e.status.book="loading"})).addCase(ce.rejected,(function(e){e.status.book="failed"})).addCase(ce.fulfilled,(function(e,t){e.status.book="idle",t.payload&&e.list.push(t.payload)})).addCase(oe.pending,(function(e){e.status.cancel="loading"})).addCase(oe.rejected,(function(e){e.status.cancel="failed"})).addCase(oe.fulfilled,(function(e,t){e.status.cancel="idle",e.list=e.list.filter((function(e){return e.id!==t.payload}))}))}}),de=function(e){return e.book.list},le=function(e){return e.book.status.book},pe=function(e){return e.book.status.cancel},fe={book:ue.reducer,stop:Q,trip:ae},je=function(){var e=o.c,t=Object(o.b)(),r=e(G),n=e(V),i=e(J),s=e(W),c=e(re),u=e(te),d=e(ne),l=e(le),p=e(pe),f=e(de),j=Object(a.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(Array.isArray(e))t(ee(e));else{var r=e;if(n.includes(r)){var a=u.filter((function(e){return e.departureStop===r}));t(ee(a))}else t(Y(r)),t(M(""!==e?n.concat(r):i))}}),[n,u,t,i]);return{currentStop:r,stopsList:i,stopReqStatus:s,tripsList:c,tripReqStatus:d,bookedList:f,bookReqStatus:l,unbookReqStatus:p,resetStop:function(){return t(z())},updateStop:function(e){return t(K(e))},resetTrips:function(){return t(Z())},updateTrips:j,fetchStopsList:function(){return t(P())},fetchTripsList:function(e){return t(Y(e))},bookTrip:function(e){return t(ce(e))},cancelBookedTrip:function(e){return t(oe(e))}}},be=Object(y.a)({reducer:fe}),xe=function(){var e=Object(b.a)().t,t=je(),r=t.currentStop,n=t.stopsList,i=t.updateStop,s=t.fetchStopsList,c=t.stopReqStatus;Object(a.useEffect)((function(){0===n.length&&s()}),[s,n.length]);return Object(T.jsx)(h.a,{className:"flex-grow-0",children:c===O.REQ_STATUS.FAILED?Object(T.jsx)("div",{children:e("errors:request.stop")}):c===O.REQ_STATUS.LOADING?Object(T.jsx)(S,{icon:"grow"}):Object(T.jsx)(v.a,{label:e("From where"),children:Object(T.jsx)(x.a.Select,{onChange:function(e){e.preventDefault(),i(e.target.value)},value:r,children:[O.SELECT_DEFAULT_VALUE].concat(n).map((function(t){return Object(T.jsx)(k,{label:t,value:t===O.SELECT_DEFAULT_VALUE?e("Choose bus stop"):t},t)}))})})})},he=r(30),ve=r(7),Oe=[],me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Oe,t=Object(a.useState)(""),r=Object(ve.a)(t,2),n=r[0],i=r[1];return Object(a.useEffect)((function(){i(e.flat().filter((function(e){return"boolean"!==typeof e})).join(" "))}),[e]),n},ge=function(e){var t=e.id,r=void 0===t?void 0:t,n=e.centered,a=void 0!==n&&n,i=e.right,s=void 0!==i&&i,c=e.bold,o=void 0!==c&&c,u=e.italic,d=void 0!==u&&u,l=e.xs,p=void 0!==l&&l,f=e.sm,j=void 0!==f&&f,b=e.md,x=void 0!==b&&b,h=e.lg,v=void 0!==h&&h,O=e.xl,g=void 0!==O&&O,S=e.xxl,k=void 0!==S&&S,y=e.green,w=void 0!==y&&y,L=e.red,E=void 0!==L&&L,C=e.blue,N=void 0!==C&&C,A=e.teal,R=void 0!==A&&A,B=e.yellow,D=void 0!==B&&B,_=e.styles,I=void 0===_?void 0:_,F=e.children,U=me(["w-100","mt-5",a&&"text-center",s&&"text-end",o&&"fw-bold",d&&"fst-italic",k&&"fs-1",g&&"fs-2",v&&"fs-3",x&&"fs-4",j&&"fs-5",p&&"fs-6",w&&"text-success",E&&"text-danger",N&&"text-primary",R&&"text-info",D&&"text-warning"]);return Object(T.jsx)(m.a,{className:U,children:Object(T.jsx)("p",{id:r,style:I,children:F})})},Te=r(18);function Se(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.forEach((function(t){var r=new Date(t);if(isNaN(r.getTime()))throw new Error("Invalid string dates given: "+t);e.push(r)})),1===e.length?e[0]:e}function ke(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=Se(e),a=function(e){return e<10?"0"+e:e},i="";if(!r){var s=a(n.getDate()),c=a(n.getMonth()+1),o=n.getFullYear();i+="".concat(s,"/").concat(c,"/").concat(o," ")}if(!t){var u=a(n.getHours()),d=a(n.getMinutes());i+="".concat(u,":").concat(d)}return i}var ye=function(e){var t=e.time,r=e.stop,n=void 0===r?void 0:r,i=e.isDateLine,s=void 0!==i&&i;return Object(T.jsx)(Te.a,{className:"d-flex justify-content-start",children:s?Object(T.jsx)(h.a,{children:ke(t,!0)}):Object(T.jsxs)(a.Fragment,{children:[Object(T.jsx)(h.a,{className:"col-3 ps-4",children:ke(t,!1,!0)}),Object(T.jsx)(h.a,{children:n})]})})},we=r(54),Le=function(e,t){return t.some((function(t){return t.id===e}))},Ee=r(57),Ce=function(e){var t=e.trip,r=void 0===t?void 0:t,n=e.book,a=void 0!==n&&n,i=e.unbook,s=void 0!==i&&i,c=e.resetCache,o=void 0!==c&&c,u=e.fetchAll,d=void 0!==u&&u,l=e.sortTable,p=void 0!==l&&l,f=e.sortBy,j=void 0===f?void 0:f,x=Object(b.a)().t,h=je(),v=h.tripsList,O=h.bookedList,m=h.bookTrip,g=h.bookReqStatus,S=h.cancelBookedTrip,k=h.resetTrips,y=h.updateTrips,w=h.resetStop,L=me([(a||s)&&"w-100","h-100","text-center","p-0",s&&["fs-4","fw-bold"],(p||o||d)&&["fs-1","py-auto"]]);return Object(T.jsx)(we.a,{className:L,onClick:function(){a&&"loading"!==g&&m(r),s&&S(r.id),o&&(k(),w()),p&&y(function(e,t){return Object(Ee.a)(e).sort((function(e,r){return"stop"===t?e.departureStop.localeCompare(r.departureStop)||e.arrivalStop.localeCompare(r.arrivalStop):new Date(e.departureTime).getTime()-new Date(r.departureTime).getTime()}))}(v,j)),d&&(w(),k(),y())},variant:a?"outline-warning":s?"outline-danger":"outline-primary",disabled:!!a&&Le(r.id,O),title:s?x("Cancel book"):p?x("date"===j?"Sort by time":"Sort by stop"):o?x("Clear cache"):d?x("Fetch all trips"):"",style:{width:o||p||d?75:""},children:a?"\ud83d\udcbe":s?"\u2716":o?"\ud83e\uddf9":d?"\ud83d\udccb":p?"stop"===j?"\ud83d\udea9":"\ud83d\udd54":"---"})},Ne=function(e){var t=e.trip;return Object(T.jsx)(he.a.Item,{className:"p-0 m-0",children:Object(T.jsxs)(m.a,{fluid:!0,className:"d-flex align-items-center ps-2 pe-0 m-0",children:[Object(T.jsxs)(h.a,{children:[Object(T.jsx)(ye,{isDateLine:!0,time:t.departureTime}),Object(T.jsx)(ye,{stop:t.departureStop,time:t.departureTime}),Object(T.jsx)(ye,{stop:t.arrivalStop,time:t.arrivalTime})]}),Object(T.jsx)(h.a,{xs:3,md:2,xl:1,className:"y-100 py-0 m-2",children:Object(T.jsx)(Ce,{unbook:!0,trip:t})})]})})},Ae=function(){var e=Object(b.a)().t,t=je().bookedList;return Object(T.jsxs)(h.a,{className:"pb-5 flex-grow-0",xs:{order:"first"},md:{order:"last"},children:[Object(T.jsx)(ge,{id:O.IDS.BOOKED_TRIPS,centered:!0,lg:!0,blue:!0,children:e("Booked trips")}),0===t.length?Object(T.jsx)(ge,{centered:!0,sm:!0,italic:!0,red:!0,children:e("No booked trip")}):Object(T.jsx)(he.a,{"aria-labelledby":O.IDS.BOOKED_TRIPS,children:t.map((function(e){return Object(T.jsx)(Ne,{trip:e},e.id)}))})]})},Re=r(55),Be=function(e){var t=e.children;return Object(T.jsxs)(h.a,{lg:5,className:"m-auto",children:[Object(T.jsx)(ge,{centered:!0,styles:{fontSize:250},children:"\ud83d\ude8f"}),Object(T.jsx)(ge,{centered:!0,lg:!0,blue:!0,children:t}),Object(T.jsx)(xe,{})]})},De=function(e){var t=e.children;return Object(T.jsx)("span",{style:{color:"#d6cd52"},title:t,children:"+"})};function _e(e,t){var r=Se(e,t),n=Object(ve.a)(r,2),a=n[0],i=n[1];[a,i].forEach((function(e){e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0)}));var s=Math.abs(i.getTime()-a.getTime());return Math.trunc(s/864e5)}var Ie=function(e){var t=e.type,r=e.value,n=e.diff,i=void 0===n?0:n,s=Object(b.a)().t,c=me([["departureStop"].includes(t)?"text-end":["arrivalStop"].includes(t)?"text-start":"text-center","arrow"===t&&["d-none","d-xl-block","col-xl-1"]]),o=Object(a.useState)(""),u=Object(ve.a)(o,2),d=u[0],l=u[1],p=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(a.useState)(e),r=Object(ve.a)(t,2),n=r[0],i=r[1];return[n,function(){return i(!n)}]}(!1),f=Object(ve.a)(p,2),j=f[0],x=f[1];return Object(a.useEffect)((function(){l(["arrivalTime","departureTime","date"].includes(t)?ke(r,"date"===t,"date"!==t):r),"arrivalTime"===t&&i>0&&x()}),[i,x,t,r]),Object(T.jsxs)(h.a,{className:c,children:[d," ",j&&Object(T.jsx)(De,{children:s("Arrival is day after",{count:i})})]})},Fe=function(e){var t=e.departure,r=e.arrival,n=e.isStopsGroup,a=void 0!==n&&n,i=e.xs,s=e.lg,c=e.xl,o=void 0===c?void 0:c,u=e.diff,d=void 0===u?0:u,l=me(["d-flex","flex-column","flex-xl-row","justify-content-around","align-items-".concat(a?"end":"center"),a&&"align-items-lg-center"]);return Object(T.jsxs)(h.a,{as:"td",className:l,xs:i,lg:s,xl:o||s,children:[Object(T.jsx)(Ie,{type:a?"departureStop":"departureTime",value:t}),Object(T.jsx)(Ie,{type:"arrow",value:O.ARROW}),Object(T.jsx)(Ie,{type:a?"arrivalStop":"arrivalTime",value:r,diff:d})]})},Ue=function(e){var t=e.trip;return Object(T.jsxs)(Te.a,{as:"tr",className:"d-flex flex-row flex-1 m-0 p-0",children:[Object(T.jsx)(Fe,{xs:5,lg:6,departure:t.departureStop,arrival:t.arrivalStop,isStopsGroup:!0}),Object(T.jsx)(h.a,{as:"td",className:"d-flex justify-content-center align-items-center",xs:{span:3,order:"first"},lg:{span:1,order:0},xl:2,children:Object(T.jsx)(Ie,{type:"date",value:t.departureTime})}),Object(T.jsx)(Fe,{xs:2,lg:3,xl:3,departure:t.departureTime,arrival:t.arrivalTime,diff:_e(t.departureTime,t.arrivalTime)}),Object(T.jsx)(h.a,{as:"td",xs:2,xl:1,className:"d-flex justify-content-center align-items-center",children:Object(T.jsx)(Ce,{book:!0,trip:t})})]})},Pe=function(){var e=Object(b.a)().t,t=je(),r=t.updateTrips,n=t.currentStop,i=t.tripsList,s=t.tripReqStatus;return Object(a.useEffect)((function(){"default"!==n&&r(n)}),[n,r]),"loading"===s?Object(T.jsx)(S,{}):0===i.length?Object(T.jsx)(Be,{children:e("From where")}):Object(T.jsxs)(Re.a,{hover:!0,size:"xl",children:[Object(T.jsx)("thead",{children:Object(T.jsxs)(Te.a,{as:"tr",className:"text-center m-0 p-0 text-primary",children:[Object(T.jsx)(h.a,{as:"th",xs:5,lg:6,children:e("Trip")}),Object(T.jsx)(h.a,{as:"th",xs:{span:3,order:"first"},lg:{span:1,order:0},xl:2,children:e("Date")}),Object(T.jsx)(h.a,{as:"th",xs:2,lg:3,children:e("Hour")}),Object(T.jsx)(h.a,{as:"th",xs:2,xl:1,children:e("Book")})]})}),Object(T.jsx)("tbody",{children:i.map((function(e){return Object(T.jsx)(Ue,{trip:e},e.id)}))})]})},qe=function(){return Object(T.jsxs)(m.a,{style:{height:75},className:"d-flex flex-row justify-content-center gap-3 mt-3",children:[Object(T.jsx)(Ce,{sortTable:!0,sortBy:"date"}),Object(T.jsx)(Ce,{sortTable:!0,sortBy:"stop"}),Object(T.jsx)(Ce,{resetCache:!0}),Object(T.jsx)(Ce,{fetchAll:!0})]})},He=function(){var e=Object(b.a)().t;return Object(T.jsxs)(m.a,{as:"main",className:"d-flex flex-row flex-wrap bg-light min-vh-100 p-0",fluid:!0,children:[Object(T.jsxs)(h.a,{xs:12,md:4,xl:3,className:"h-lg-100 py-5 px-sm-2 d-flex flex-column bg-warning",children:[Object(T.jsx)(xe,{}),Object(T.jsx)(qe,{}),Object(T.jsx)(Ae,{})]}),Object(T.jsxs)(h.a,{xs:12,md:8,xl:9,className:"px-md-2 px-lg-2 px-xl-5 my-5",children:[Object(T.jsx)(ge,{xxl:!0,bold:!0,centered:!0,blue:!0,children:e("Available trips list")}),Object(T.jsx)(Pe,{})]})]})},ze=function(){return Object(T.jsx)(He,{})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(Object(T.jsx)(i.a.StrictMode,{children:Object(T.jsx)(o.a,{store:be,children:Object(T.jsx)(ze,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[96,1,2]]]);
//# sourceMappingURL=main.f359de41.chunk.js.map